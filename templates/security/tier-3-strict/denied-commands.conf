# ──────────────────────────────────────────────────────────────
# denied-commands.conf (Tier 3 — Strict)
#
# Extended deny list with bypass prevention, interpreter blocking,
# and shell-tool denial (forces use of Claude's built-in tools).
#
# Format and pattern matching: same as tier-2 (see that file).
# ──────────────────────────────────────────────────────────────

# --- Destructive operations ---
Bash(rm -rf *)
Bash(rm -r /*)
Bash(rm -r ~*)

# --- Privilege escalation ---
Bash(sudo)
Bash(sudo *)
Bash(su -)
Bash(su root)

# --- Dangerous git operations ---
Bash(git push --force *)
Bash(git push -f *)
Bash(git reset --hard *)
Bash(git clean -fd *)
Bash(git checkout .)

# --- Shell builtins that bypass deny rules ---
Bash(command)
Bash(command *)
Bash(eval)
Bash(eval *)
Bash(exec)
Bash(exec *)

# --- Command wrappers that bypass deny rules ---
Bash(bash)
Bash(bash *)
Bash(env)
Bash(env *)
Bash(nice)
Bash(nice *)
Bash(nohup)
Bash(nohup *)
Bash(sh)
Bash(sh *)
Bash(sudo)
Bash(sudo *)
Bash(time)
Bash(time *)
Bash(timeout)
Bash(timeout *)
Bash(watch)
Bash(watch *)
Bash(xargs)
Bash(xargs *)

# --- Interpreter execution (arbitrary code) ---
# Block inline code execution; doesn't block running .py/.js files
Bash(node)
Bash(node *)
Bash(perl)
Bash(perl *)
Bash(python3 -c)
Bash(python3 -c *)
Bash(python -c)
Bash(python -c *)
Bash(ruby)
Bash(ruby *)

# --- Shell equivalents of dedicated tools ---
# Force use of Claude's built-in Read/Grep/Glob/Edit tools (safer, auditable)
Bash(awk)
Bash(awk *)
Bash(cat)
Bash(cat *)
Bash(find)
Bash(find *)
Bash(grep)
Bash(grep *)
Bash(head)
Bash(head *)
Bash(rg)
Bash(rg *)
Bash(sed)
Bash(sed *)
Bash(tail)
Bash(tail *)

# --- Network exfiltration ---
Bash(curl)
Bash(curl *)
Bash(wget)
Bash(wget *)

# --- System modification ---
Bash(chmod 777 *)
Bash(chmod -R *)
Bash(chown -R *)
Bash(mkfs *)
Bash(dd if=*)
Bash(dd of=/dev/*)

# --- Database destruction ---
# These match if the command contains these SQL keywords at the start
Bash(DROP DATABASE *)
Bash(DROP TABLE *)
Bash(TRUNCATE TABLE *)
Bash(DELETE FROM *)
