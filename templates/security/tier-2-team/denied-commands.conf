# ──────────────────────────────────────────────────────────────
# denied-commands.conf — Bash commands the agent is blocked from
# running. Deny rules take precedence over allowed-commands.conf.
#
# Read by pretooluse-command-filter.sh (PreToolUse hook).
# Changes require a Claude session restart to take effect.
# ──────────────────────────────────────────────────────────────
#
# FORMAT
#   Bash(<glob-pattern>)
#
#   One entry per line. Blank lines and comments (#) are ignored.
#   Use BOTH Bash(cmd) and Bash(cmd *) for each denied command —
#   Bash(cmd) blocks the bare command, Bash(cmd *) blocks with args.
#
# PATTERN MATCHING (bash glob via case statement)
#   Bash(env)         — exact match: blocks "env" with no arguments
#   Bash(env *)       — prefix + args: blocks "env VAR=x cmd"
#                       Does NOT match "printenv" (space enforces boundary)
#   Bash(python3 -c)  — exact: blocks "python3 -c" with no further args
#   Bash(python3 -c *)— blocks "python3 -c 'code'"
#
# MAINTENANCE
#   - Keep entries alphabetically sorted within each section.
#   - After editing, restart the Claude session for changes to take effect.
# ──────────────────────────────────────────────────────────────

# --- Destructive operations ---
Bash(rm -rf *)
Bash(rm -r /*)
Bash(rm -r ~*)

# --- Privilege escalation ---
Bash(sudo)
Bash(sudo *)

# --- Dangerous git operations ---
Bash(git push --force *)
Bash(git push -f *)
Bash(git reset --hard *)
Bash(git clean -fd *)

# --- Shell builtins that bypass deny rules ---
Bash(command)
Bash(command *)
Bash(eval)
Bash(eval *)
Bash(exec)
Bash(exec *)

# --- Command wrappers that bypass deny rules ---
# These prefix arbitrary commands, letting agents run denied tools indirectly.
# Validated by NVIDIA AI Red Team framework.
Bash(bash)
Bash(bash *)
Bash(env)
Bash(env *)
Bash(nice)
Bash(nice *)
Bash(nohup)
Bash(nohup *)
Bash(sh)
Bash(sh *)
Bash(time)
Bash(time *)
Bash(timeout)
Bash(timeout *)
Bash(watch)
Bash(watch *)
Bash(xargs)
Bash(xargs *)

# --- Network exfiltration ---
Bash(curl)
Bash(curl *)
Bash(wget)
Bash(wget *)

# --- System modification ---
Bash(chmod 777 *)
Bash(chmod -R *)
Bash(chown -R *)
Bash(mkfs *)
Bash(dd if=*)
Bash(dd of=/dev/*)
